import{r as V,a as g}from"./index-3b05413c.js";import{d as k,K as h,Q as b,O as y,P as N,L as F,W as D,n as c,C as A,X as E,S as f,Y as U,T as $,U as I,o as R,g as S,w as l,V as i,b as o,e as w,t as L,i as v}from"./index-bb1bbfdc.js";/* empty css              */const O=k({components:{NButton:h,NCard:b,NForm:y,NFormItem:N,NInput:F,NSpace:D},setup(){const e=$(),s=c(null),r=A(),d=c(0);var a=c({password:"",repassword:"",code:"",mail:""});return{countdown:d,formRef:s,formValue:a,async handleValidateClick(p){var t;p.preventDefault(),(t=s.value)==null||t.validate(async u=>{if(!E(a.value.password)){r.error("密码只允许5到16位的字母或数字");return}if(a.value.password!=a.value.repassword){r.error("输入的两次密码不一致");return}u&&r.error("检查你的信息");const m=await V(a.value.mail,a.value.code,a.value.password);m.message=="注册成功"?(r.success("注册成功"),f("User",JSON.stringify({mail:a.value.mail,password:a.value.password}),31),f("mail",a.value.mail,31),f("password",a.value.password,31),e.push({name:"Login"})):r.error(m.message)})},async getVerificationCode(){if(!(d.value>0))try{if(!U(a.value.mail)){r.error("请输入正确的邮箱");return}const p=a.value.mail;if((await g(p)).message=="邮件发送成功"){r.success("验证码已经发送成功！请查收邮箱"),d.value=60;const u=setInterval(()=>{d.value-=1,d.value<=0&&clearInterval(u)},1e3)}else r.error("验证码发送失败！请检查您输入的邮箱")}catch{r.error("请在一分钟后输入正确的邮箱")}}}}}),P={class:"text-center mt-2"},T=v("a",null,[v("span",{class:"linkcolor"}," 返回登录")],-1);function J(e,s,r,d,a,p){const t=i("n-input"),u=i("n-form-item"),m=i("n-button"),C=i("n-form"),_=i("router-link"),B=i("n-card");return R(),S(B,{class:"element"},{default:l(()=>[o(C,{ref:"formRef","label-width":80,model:e.formValue},{default:l(()=>[o(u,{label:"邮箱",path:"mail"},{default:l(()=>[o(t,{value:e.formValue.mail,"onUpdate:value":s[0]||(s[0]=n=>e.formValue.mail=n),placeholder:"输入邮箱"},null,8,["value"])]),_:1}),o(u,{label:"验证码",path:"code"},{default:l(()=>[o(t,{value:e.formValue.code,"onUpdate:value":s[1]||(s[1]=n=>e.formValue.code=n),placeholder:"输入验证码"},null,8,["value"]),o(m,{onClick:e.getVerificationCode,disabled:e.countdown>0},{default:l(()=>[w(L(e.countdown>0?`${e.countdown}s`:"获取验证码"),1)]),_:1},8,["onClick","disabled"])]),_:1}),o(u,{label:"密码",path:"password"},{default:l(()=>[o(t,{value:e.formValue.password,"onUpdate:value":s[2]||(s[2]=n=>e.formValue.password=n),type:"password",placeholder:"输入密码"},null,8,["value"])]),_:1}),o(u,{label:"确认密码",path:"repassword"},{default:l(()=>[o(t,{value:e.formValue.repassword,"onUpdate:value":s[3]||(s[3]=n=>e.formValue.repassword=n),type:"password",placeholder:"重复输入密码"},null,8,["value"])]),_:1}),o(u,null,{default:l(()=>[o(m,{type:"primary",class:"full-width-button",onClick:e.handleValidateClick},{default:l(()=>[w(" 注册 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),v("p",P,[o(_,{to:"/login"},{default:l(()=>[T]),_:1})])]),_:1})}const W=I(O,[["render",J]]);export{W as default};
